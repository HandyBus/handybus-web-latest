name: PR Labeler
on:
  pull_request:
    types: [opened, edited]

jobs:
  label-pr:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Label PR based on title
        uses: actions/github-script@v6
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const prTitle = context.payload.pull_request.title.toLowerCase();
            const prBody = context.payload.pull_request.body ? context.payload.pull_request.body.toLowerCase() : '';
            
            // íƒ€ìž… íŒ¨í„´ ì •ì˜ (ì •ê·œì‹ìœ¼ë¡œ í™•ìž¥ ê°€ëŠ¥)
            const typePatterns = {
              'release': ['ðŸ”– release'],
              'feat': ['âœ¨ feature'],
              'fix': ['ðŸ› fix'],
              'hotfix': ['ðŸ”¥ hotfix'],
              'design': ['ðŸŽ¨ design', 'ðŸŽ¨ ui', 'ðŸŽ¨ ux'],
              'docs': ['ðŸ“š docs', 'ðŸ“š documentation'],
              'chore': ['ðŸ§¹ chore'],
              'refactor': ['ðŸ”„ refactor'],
              'test': ['ðŸ§ª test'],
              'init': ['ðŸŒ± init'],
              'build': ['ðŸ”¨ build'],
              'ci': ['ðŸ”„ ci'],
              'perf': ['ðŸŽï¸ perf'],
              'style': ['ðŸ’„ style'],
              'rename': ['ðŸ”„ rename'],
            };
            
            // íƒ€ìž…ì— ë§žëŠ” ë¼ë²¨ ì°¾ê¸°
            const labelsToAdd = [];
            for (const [label, patterns] of Object.entries(typePatterns)) {
              if (patterns.some(pattern => 
                prTitle.includes(pattern) || 
                (prTitle.startsWith(pattern + ':') || prTitle.startsWith(pattern + '(')) ||
                prBody.includes(pattern + ':')
              )) {
                labelsToAdd.push(label);
              }
            }
            
            // ë¼ë²¨ ì¶”ê°€
            if (labelsToAdd.length > 0) {
              await github.rest.issues.addLabels({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.issue.number,
                labels: labelsToAdd
              });
              console.log(`Added labels: ${labelsToAdd.join(', ')}`);
            } else {
              console.log('No matching labels found');
            }
