name: PR Labeler
on:
  pull_request:
    types: [opened, edited]

jobs:
  label-pr:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Label PR based on title
        uses: actions/github-script@v6
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const prTitle = context.payload.pull_request.title.toLowerCase();
            const prBody = context.payload.pull_request.body ? context.payload.pull_request.body.toLowerCase() : '';
            
            // ÌÉÄÏûÖ Ìå®ÌÑ¥ Ï†ïÏùò (Ï†ïÍ∑úÏãùÏúºÎ°ú ÌôïÏû• Í∞ÄÎä•)
            const typePatterns = {
              'release': ['üîñ release'],
              'feat': ['‚ú® feature'],
              'fix': ['üêõ fix'],
              'hotfix': ['üî• hotfix'],
              'design': ['üé® design', 'üé® ui', 'üé® ux'],
              'docs': ['üìö docs', 'üìö documentation'],
              'chore': ['üßπ chore'],
              'refactor': ['üîÑ refactor'],
              'test': ['üß™ test'],
              'init': ['üå± init'],
              'build': ['üî® build'],
              'ci': ['üîÑ ci'],
              'perf': ['üèéÔ∏è perf'],
              'style': ['üíÑ style'],
              'rename': ['üîÑ rename'],
            };
            
            // ÌÉÄÏûÖÏóê ÎßûÎäî ÎùºÎ≤® Ï∞æÍ∏∞
            const labelsToAdd = [];
            for (const [label, patterns] of Object.entries(typePatterns)) {
              if (patterns.some(pattern => 
                prTitle.includes(pattern) || 
                (prTitle.startsWith(pattern + ':') || prTitle.startsWith(pattern + '(')) ||
                prBody.includes(pattern + ':')
              )) {
                labelsToAdd.push(label);
              }
            }
            
            // ÎùºÎ≤® Ï∂îÍ∞Ä
            if (labelsToAdd.length > 0) {
              await github.rest.issues.addLabels({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.issue.number,
                labels: labelsToAdd
              });
              console.log(`Added labels: ${labelsToAdd.join(', ')}`);
            } else {
              console.log('No matching labels found');
            }

// Ïù¥Î™®ÏßÄ Ï∞∏Ï°∞ : https://inpa.tistory.com/entry/GIT-%E2%9A%A1%EF%B8%8F-Gitmoji-%EC%82%AC%EC%9A%A9%EB%B2%95-Gitmoji-cli